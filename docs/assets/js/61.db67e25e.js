(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{218:function(t,e,_){"use strict";_.r(e);var v=_(0),s=Object(v.a)({},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),_("p",[t._v("前后端分离开发时")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),_("p",[t._v("当然是为了安全啊")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),_("comment-comment")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"关闭-chrome-的安全策略：可用于跨域"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关闭-chrome-的安全策略：可用于跨域","aria-hidden":"true"}},[this._v("#")]),this._v(" 关闭 "),e("code",[this._v("chrome")]),this._v(" 的安全策略：可用于跨域")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("对于 "),e("code",[this._v("Linux")]),this._v("，终端执行:\n"),e("code",[this._v("google-chrome --disable-web-security --user-data-dir=<path to store the data>")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("如 "),e("code",[this._v("google-chrome --disable-web-security --user-data-dir=/home/xu/test-dir")])])])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[t._v("其中 "),_("code",[t._v("--disable-web-security")]),t._v(" 选项关闭 "),_("code",[t._v("web")]),t._v(" 的一些安全策略【其中包括阻止不合法的跨域请求】。")]),t._v(" "),_("li",[t._v("在 "),_("code",[t._v("Linux")]),t._v(" 下，如果要关闭安全策略，则必须指定一个目录 "),_("code",[t._v("user-data-dir")]),t._v(" 用于保存这样运行浏览器所产生的一些数据")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"使用场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用场景","aria-hidden":"true"}},[this._v("#")]),this._v(" 使用场景")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("前端运行在 "),e("code",[this._v("http://localhost:8080")])]),this._v(" "),e("li",[this._v("后端运行在 "),e("code",[this._v("http://localhost:8000")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这时前端对后端发起请求属于跨域了（只要协议、域名、端口有任何一个的不同，就被当作是跨域——不同"),e("strong",[this._v("域")]),this._v("），正式上线网站的时候一般都会把前后端放到一个"),e("strong",[this._v("域")]),this._v("里，比如将前端打包成静态资源后使用 "),e("code",[this._v("nginx")]),this._v(" 进行部署或者直接由和后台代码放在一起。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"限制跨域访问是浏览器的安全策略，主要有两种："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#限制跨域访问是浏览器的安全策略，主要有两种：","aria-hidden":"true"}},[this._v("#")]),this._v(" 限制跨域访问是浏览器的安全策略，主要有两种：")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ul",[_("li",[_("code",[t._v("DOM")]),t._v(" 同源策略：禁止对不同源页面 "),_("code",[t._v("DOM")]),t._v(" 进行操作。这里主要场景是 "),_("code",[t._v("iframe")]),t._v(" 跨域的情况，不同"),_("strong",[t._v("域")]),t._v("的 "),_("code",[t._v("iframe")]),t._v(" 是限制互相访问的。")]),t._v(" "),_("li",[_("code",[t._v("XMLHttpRequest")]),t._v(" 同源策略：禁止使用 "),_("code",[t._v("XHR")]),t._v(" 对象向不同"),_("strong",[t._v("域")]),t._v("发起 "),_("code",[t._v("HTTP")]),t._v(" 请求。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"为什么浏览器要这样做？"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为什么浏览器要这样做？","aria-hidden":"true"}},[this._v("#")]),this._v(" 为什么浏览器要这样做？")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("我们假设有两个"),e("strong",[this._v("域")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("strong",[this._v("域")]),this._v("1：存着你血汗钱的网站： "),e("code",[this._v("http://money.com")])]),this._v(" "),e("li",[e("strong",[this._v("域")]),this._v("：一个恶意网站： "),e("code",[this._v("http://坏人.com")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("为了方便在客户端存储少量信息，浏览器推出了 "),e("code",[this._v("cookie")]),this._v(" 这样的功能。")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("blockquote",[_("p",[t._v("即浏览器每次发起 "),_("code",[t._v("http")]),t._v(" 请求，浏览器都会自动带上这个"),_("strong",[t._v("域")]),t._v("的 "),_("code",[t._v("cookie")]),t._v("， 比如访问 "),_("code",[t._v("http://money.com")]),t._v(" 的主页，浏览器则会自动帮你带上 "),_("code",[t._v("http://money.com")]),t._v(" 这个"),_("strong",[t._v("域")]),t._v("的 "),_("code",[t._v("cookie")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("这样可以很方便的使得 "),e("code",[this._v("http://money.com")]),this._v(" 的后台程序根据 "),e("code",[this._v("cookie")]),this._v(" 所携带的信息来改善用户的使用体验，最常用的就是以此来识别用户，使用户保持登录状态。但是这样有一个副作用：")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("blockquote",[_("p",[t._v("即使你是在其它"),_("strong",[t._v("域")]),t._v("通过 "),_("code",[t._v("XMLHttpRequest")]),t._v(" 对象发起这个 "),_("code",[t._v("http")]),t._v(" 请求，也同样是带上 "),_("code",[t._v("money.com")]),t._v(" 这个"),_("strong",[t._v("域")]),t._v("的 "),_("code",[t._v("cookie")]),t._v("。这就给坏人带来了机会")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("试想这样一个场景")]),this._v(":")])},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("p",[t._v("你刚登录了 "),_("code",[t._v("http://money.com")]),t._v(" 这个网站，验证信息保存在 "),_("code",[t._v("cookie")]),t._v(" 里，而且还没有过期。然后你又进入了 "),_("code",[t._v("http://坏人.com")]),t._v(" 这个网站，坏人网站载入的时候就在后台用 "),_("code",[t._v("XMLHttpRequest")]),t._v(" 对象向 "),_("code",[t._v("http://money.com")]),t._v(" 发请求。如果浏览器不管不顾，直接就允许了，那这个请求就带着 "),_("code",[t._v("cookie")]),t._v(" 发出去了，服务端一看 "),_("code",[t._v("cookie")]),t._v(" 里的验证信息，是 "),_("code",[t._v("OK")]),t._v(" 的。坏人不就得到服务器返回的信息了么，然后他就拿着你的信息做坏事了，好可怕。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("实际上呢，以 "),e("code",[this._v("google-chrome")]),this._v(" 为例（"),e("code",[this._v("google-chrome")]),this._v(" 默认打开了相关的安全策略）：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("如果服务端允许任何其它域来请求：则允许这个请求，然后坏人就得逞了。")]),this._v(" "),e("li",[this._v("如果服务端只允许指定的域来请求：发现这个请求来自于"),e("code",[this._v("http://坏人.com")]),this._v(" 域，不在设定的许可名单里，则不会允许这个陌生的请求")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("当我们关闭了 "),e("code",[this._v("google-chrome")]),this._v(" 的安全策略的时候，这个请求直接就发出去了，根本不管服务端允许不允许的。这是怎么实现的呢，请求里不带发送域或者是直接将发送域替换成目的域吗？")])])}],!1,null,null,null);e.default=s.exports}}]);