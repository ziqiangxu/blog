(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{211:function(e,t,s){"use strict";s.r(t);var a=s(0),i=Object(a.a)({},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[e._m(0),e._v(" "),s("p",[s("a",{attrs:{href:"https://www.deepin.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("deepin官网"),s("OutboundLink")],1),e._v("\n休眠这个功能还是很酷很实用的，对于 "),s("code",[e._v("Linux")]),e._v(" 系统，休眠一般就是把内存中的数据写入硬盘（"),s("code",[e._v("swap")]),e._v("文件），然后关机。在下一次开机的时候将数据重新载入内存，让你快速回到上一次的工作状态，这在你开启了大量的程序但需要暂停工作的时候尤其好用。")]),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),s("p",[e._v("如果你没办法从硬盘划分一个swap分区，你可以通过使用swap文件来进行休眠。\n"),s("a",{attrs:{href:"https://wiki.debian.org/Hibernation/Hibernate_Without_Swap_Partition",target:"_blank",rel:"noopener noreferrer"}},[e._v("本教程参考了Debian的wiki"),s("OutboundLink")],1),e._v("\n大体思路：创建swap文件--\x3e配置swap文件--\x3e安装uswsusp--\x3e配置uswsusp")]),e._v(" "),e._m(5),e._v(" "),e._m(6),s("p",[e._v("“256”是指以MB为单位的大小（其后的'm'）。将其设置为RAM的至少一半大小(这个是debian wiki给定的数据，我建议设置为至少设置为内存相同大小)。“/swap”是交换文件的路径。它可以位于任何分区（例如root或home）。")]),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),s("blockquote",[s("p",[s("a",{attrs:{href:"http://blog.sina.com.cn/s/blog_13cc013b50102wskd.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("vm.swappiness扩展知识"),s("OutboundLink")],1),e._v("\n减少内核对 "),s("code",[e._v("swap")]),e._v(" 的使用这一步主要是针对使用机械硬盘的同学，因为在机械硬盘中大量对 "),s("code",[e._v("swap")]),e._v(" 进行读写会拖慢系统的速度， Debian wiki 里面写的是停止内核使用 "),s("code",[e._v("swap")]),e._v(" 文件，可能是原作者笔误，也可能是他瞎说的🤗")])]),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),s("p",[e._v("使用uswsusp这个软件，这是linux内核使用swap文件代替swap分区来进行挂起（休眠）的方法，并且还支持压缩和加密等功能。")]),e._v(" "),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),s("p",[e._v("一般配置文件/etc/uswsusp.conf内容如下所示：")]),e._v(" "),e._m(16),e._m(17),e._v(" "),e._m(18),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),e._m(21),e._v(" "),e._m(22),e._v(" "),e._m(23),e._m(24),e._v(" "),e._m(25)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"deepin-如何休眠"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#deepin-如何休眠","aria-hidden":"true"}},[this._v("#")]),this._v(" "),t("code",[this._v("Deepin")]),this._v(" 如何休眠")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"情况一"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#情况一","aria-hidden":"true"}},[this._v("#")]),this._v(" 情况一")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("如果你的电脑有 "),t("code",[this._v("swap")]),this._v(" 分区， "),t("code",[this._v("deepin")]),this._v(" 会探测到，关机的时候会有休眠选项了，这个功能终于加到关机菜单里了，给 "),t("code",[this._v("deepin")]),this._v(" 点赞。")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("s",[e._v("一般来说，如果你有一个可以正常使用的swap分区，只需要在终端执行")]),e._v(" "),s("s",[s("code",[e._v("systemctl hibernate")])]),e._v(" "),s("s",[e._v("就可以休眠了。")]),e._v(" "),s("s",[e._v("如果你休眠之后开机发现你的电脑并没有恢复现场，则需要指定一下启动的磁盘（从swap分区启动），操作方法如下：")]),e._v(" "),s("s",[e._v("修改/etc/default/grub这个文件中的相关内容")]),e._v(" "),s("s",[s("code",[e._v('GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda3 quiet"')]),e._v("\n其中/dev/sda3改为你的swap分区对应的标志即可（推荐使用gparted查看）\n然后再执行")]),e._v(" "),s("s",[s("code",[e._v("sudo update-grub")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"情况二"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#情况二","aria-hidden":"true"}},[this._v("#")]),this._v(" 情况二")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"_1-创建一个swap文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建一个swap文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. 创建一个swap文件")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("fallocate -l 256m /swap\nmkswap /swap\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"_2-进行swap文件相关设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-进行swap文件相关设置","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 进行swap文件相关设置")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("p",[this._v("挂载swap文件\n将此行添加到/etc/fstab文件中：\n"),t("code",[this._v("/swap swap swap defaults 0 0")])])]),this._v(" "),t("li",[t("p",[this._v("减少使用swap文件\n终端执行 "),t("code",[this._v("sudo sysctl -w vm.swappiness = 1")]),this._v("\n并在/etc/sysctl.d中创建一个名为local.conf的文件，为了使vm.swappiness保持不变，文件内容如下:")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("vm.swappiness = 1\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("激活swap文件：\n终端执行 "),t("code",[this._v("sudo swapon /swap")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"_3-安装和配置相关软件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装和配置相关软件","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 安装和配置相关软件")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("p",[this._v("安装uswsusp：\n终端执行 "),t("code",[this._v("aptitude install uswsusp")])])]),this._v(" "),t("li",[t("p",[this._v("配置uswsusp：\n终端执行 "),t("code",[this._v("sudo dpkg-reconfigure -pmedium uswsusp")]),this._v("，然后会出现如下提示框\n"),t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/6434906-f8a2c6817f602996.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"深度截图_选择区域_20180605160224.png"}}),this._v("\n从这个问题开始全部选择确定，直到出现：")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/6434906-56736ba5323f58ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"选择swap文件"}}),this._v("\n此处选择你要使用的swap文件，注：我这里是/var/swapfile这个文件")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/6434906-e5389c6168ee53db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"选择是否对休眠写入swap的数据加密"}}),this._v("\n根据需要选择就好（需要知晓的是，开启加密功能之后休眠的启动所消耗的时间会增加）。如果选择加密的话，它会提示你设定一个密码")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("对uswsusp进行进一步配置")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("＃/etc/uswsusp.conf（8） -- Configuration file for s2disk / s2both\n\nresume device= /swap\n\ncompress = y\n\nearly writeout= y\n\nimage size= 238941634\n\nRSA key file = /etc/uswsusp.key\n\nshutdown method = platform\n\nresume offset = 8288\n\n# encrypt = y 如果你选择了对数据加密，则会有这一行\n")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("code",[e._v("resume offset = 8288")]),e._v(" 是交换文件实际存放的地方（应该是硬盘的物理地址）。你可以终端执行 "),s("code",[e._v("swap-offset /swap")]),e._v(" 获得这个值。\n"),s("code",[e._v("resume device")]),e._v(" 必须是分区而不是交换文件。一般这行的值会在上一步完成后变成你的 "),s("code",[e._v("swap")]),e._v(" 文件的路径，需要改成你的 "),s("code",[e._v("swap")]),e._v(" 文件所在的分区，如 "),s("code",[e._v("/dev/sda1")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("编辑 "),t("code",[this._v("/etc/uswsusp.conf")]),this._v(" 文件后：\n终端执行 "),t("code",[this._v("sudo update-initramfs -u")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ol",[s("li",[e._v("默认启动的配置\n为了让系统启动时，默认从swap文件加载数据。将 "),s("code",[e._v("/etc/default/grub")]),e._v(" 文件中的相关设置进行修改：\n"),s("code",[e._v('GRUB_CMDLINE_LINUX_DEFAULT ="resume = /dev/sda1 quiet"')]),e._v("\n其中 "),s("code",[e._v("/dev/sda1")]),e._v(" 是交换文件所在的分区。\n终端执行 "),s("code",[e._v("sudo update-grub")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"测试休眠"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试休眠","aria-hidden":"true"}},[this._v("#")]),this._v(" 测试休眠")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("终端执行："),t("code",[this._v("sudo s2disk")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("注")]),this._v("：配置成功之后，如果再次修改了uswsusp的设置需要执行")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("sudo update-initramfs -u\nsudo update-grub\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"附录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附录","aria-hidden":"true"}},[this._v("#")]),this._v(" 附录")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[e._v("如果你的磁盘分区结构变了，比如 "),s("code",[e._v("sda3")]),e._v(" 变成了 "),s("code",[e._v("sda4")]),e._v("，按照上面步骤再来一遍就好啦（因为需要更新 "),s("code",[e._v("grub")]),e._v(" 和 "),s("code",[e._v("uswsusp.conf")]),e._v("）。")])}],!1,null,null,null);t.default=i.exports}}]);