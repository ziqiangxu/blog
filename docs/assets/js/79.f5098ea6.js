(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{173:function(t,n,e){"use strict";e.r(n);var i=e(0),s=Object(i.a)({},function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"content"},[this._m(0),n("p",[n("img",{attrs:{src:"https://upload-images.jianshu.io/upload_images/6434906-f9c35524dc87577e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"附图"}}),this._v("\n操作其他的设备类似，不过要提前了解相关的数据结构\n但是这种监听是需要有设备文件的读取权限的（默认root用户才有），read函数是系统函数，阻塞地读取设备文件，当设备文件中的缓存为空时挂起等待。\n推荐"),n("a",{attrs:{href:"https://www.jianshu.com/p/80cf81413d31",target:"_blank",rel:"noopener noreferrer"}},[this._v("Linux全局事件监听技术"),n("OutboundLink")],1)])])},[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[this._v('#include <stdio.h>\n#include <linux/input.h>\n#include <fcntl.h>\n#include <unistd.h>\n\n#define DEV_PATH "/dev/input/event5"   //根据需要修改为你的键盘对应的设备文件，可以直接sudo cat /dev/input/event5并按键盘，看是否有输出，见附图\n\nint main()\n{\n\tint keys_fd;  //文件标志\n\tchar ret[2];\n\tstruct input_event t;  //读取到的input设备数据是一个结构体\n\t\n\tkeys_fd = open(DEV_PATH, O_RDONLY);  //权限不通过的时候一般会返回-1\n\tif(keys_fd <= 0)\n\t{\n\t\tprintf("open /dev/input/event2 device error!\\n");\n\t\treturn -1;\n\t}\n\twhile(1)\n\t{\n\t\tif(\n\t\t\tread(keys_fd, &t, sizeof(t)) == sizeof(t)\n\t\t\t)  /*keys_fd指向打开的设备文件，read将从设备文件传送sizeof(t)个字节的数据到&t这个内存地址。函数执行顺利的话返回值是实际读取的字节数*/\n\t\t{\n\t\t\tif(t.type == EV_KEY)\n\t\t\t{\n\t\t\t\tif(t.value==0 || t.value==1)\n\t\t\t\t{\n\t\t\t\t\tprintf("key %d %s\\n", t.code, (t.value) ? "Pressed" : "Released");  //t.code值所对应的按键在/usr/include/linux/input-event-codes.h可以查到\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tclose(keys_fd);\n\t\n\treturn 0;\n}\n')])])])}],!1,null,null,null);n.default=s.exports}}]);