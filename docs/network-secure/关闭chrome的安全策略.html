<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>关闭 chrome 的安全策略：可用于跨域 | Daryl's blog</title><meta name="description" content="从开源中来，到开源中去!"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.22">
    <link rel="preload" href="/blog/assets/js/runtime~app.db6fef8c.js" as="script"><link rel="preload" href="/blog/assets/css/styles.7ea6cc62.css" as="style"><link rel="preload" href="/blog/assets/js/4640.00e4fdf7.js" as="script"><link rel="preload" href="/blog/assets/js/app.dc61d781.js" as="script">
    <link rel="stylesheet" href="/blog/assets/css/styles.7ea6cc62.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/blog/" class=""><!----><span class="site-name">Daryl&#39;s blog</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/blog/accumulation/" class="nav-link" aria-label="未分类"><!--[--><!--]--> 未分类 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/personal-diary/" class="nav-link" aria-label="随笔"><!--[--><!--]--> 随笔 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/computer-vision/" class="nav-link" aria-label="CV"><!--[--><!--]--> CV <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程语言"><span class="title">编程语言</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="编程语言"><span class="title">编程语言</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/Java/" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Python/" class="nav-link" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/C/" class="nav-link" aria-label="C/C++"><!--[--><!--]--> C/C++ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/ECMAScript/" class="nav-link" aria-label="ECMAScript"><!--[--><!--]--> ECMAScript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="其它"><span class="title">其它</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="其它"><span class="title">其它</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/software-engineering/" class="nav-link" aria-label="软件工程"><!--[--><!--]--> 软件工程 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/data-structure/" class="nav-link" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/OS/" class="nav-link" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Qt/" class="nav-link" aria-label="Qt"><!--[--><!--]--> Qt <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Docker/" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/network-secure/" class="nav-link router-link-active" aria-label="网络安全"><!--[--><!--]--> 网络安全 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/blog/network-secure/about-me.md" class="nav-link" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ziqiangxu/ziqiangxu.github.io" rel="noopener noreferrer" target="_blank" aria-label="博客源码"><!--[--><!--]--> 博客源码 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/blog/accumulation/" class="nav-link" aria-label="未分类"><!--[--><!--]--> 未分类 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/personal-diary/" class="nav-link" aria-label="随笔"><!--[--><!--]--> 随笔 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/blog/computer-vision/" class="nav-link" aria-label="CV"><!--[--><!--]--> CV <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="编程语言"><span class="title">编程语言</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="编程语言"><span class="title">编程语言</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/Java/" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Python/" class="nav-link" aria-label="Python"><!--[--><!--]--> Python <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/C/" class="nav-link" aria-label="C/C++"><!--[--><!--]--> C/C++ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/ECMAScript/" class="nav-link" aria-label="ECMAScript"><!--[--><!--]--> ECMAScript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="其它"><span class="title">其它</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="其它"><span class="title">其它</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog/software-engineering/" class="nav-link" aria-label="软件工程"><!--[--><!--]--> 软件工程 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/data-structure/" class="nav-link" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/OS/" class="nav-link" aria-label="操作系统"><!--[--><!--]--> 操作系统 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Qt/" class="nav-link" aria-label="Qt"><!--[--><!--]--> Qt <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/Docker/" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog/network-secure/" class="nav-link router-link-active" aria-label="网络安全"><!--[--><!--]--> 网络安全 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a href="/blog/network-secure/about-me.md" class="nav-link" aria-label="关于我"><!--[--><!--]--> 关于我 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ziqiangxu/ziqiangxu.github.io" rel="noopener noreferrer" target="_blank" aria-label="博客源码"><!--[--><!--]--> 博客源码 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">关闭 chrome 的安全策略：可用于跨域</p><ul class=""><li><!--[--><a aria-current="page" href="/blog/network-secure/%E5%85%B3%E9%97%ADchrome%E7%9A%84%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5.html#使用场景" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="使用场景"><!--[--><!--]--> 使用场景 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/network-secure/%E5%85%B3%E9%97%ADchrome%E7%9A%84%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5.html#限制跨域访问是浏览器的安全策略-主要有两种" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="限制跨域访问是浏览器的安全策略，主要有两种："><!--[--><!--]--> 限制跨域访问是浏览器的安全策略，主要有两种： <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog/network-secure/%E5%85%B3%E9%97%ADchrome%E7%9A%84%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5.html#为什么浏览器要这样做" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="为什么浏览器要这样做？"><!--[--><!--]--> 为什么浏览器要这样做？ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="关闭-chrome-的安全策略-可用于跨域" tabindex="-1"><a class="header-anchor" href="#关闭-chrome-的安全策略-可用于跨域" aria-hidden="true">#</a> 关闭 <code>chrome</code> 的安全策略：可用于跨域</h1><p>对于 <code>Linux</code>，终端执行: <code>google-chrome --disable-web-security --user-data-dir=&lt;path to store the data&gt;</code>。</p><blockquote><p>如 <code>google-chrome --disable-web-security --user-data-dir=/home/xu/test-dir</code></p></blockquote><ul><li>其中 <code>--disable-web-security</code> 选项关闭 <code>web</code> 的一些安全策略【其中包括阻止不合法的跨域请求】。</li><li>在 <code>Linux</code> 下，如果要关闭安全策略，则必须指定一个目录 <code>user-data-dir</code> 用于保存这样运行浏览器所产生的一些数据</li></ul><h2 id="使用场景" tabindex="-1"><a class="header-anchor" href="#使用场景" aria-hidden="true">#</a> 使用场景</h2><p>前后端分离开发时</p><ul><li>前端运行在 <code>http://localhost:8080</code></li><li>后端运行在 <code>http://localhost:8000</code></li></ul><p>这时前端对后端发起请求属于跨域了（只要协议、域名、端口有任何一个的不同，就被当作是跨域——不同<strong>域</strong>），正式上线网站的时候一般都会把前后端放到一个<strong>域</strong>里，比如将前端打包成静态资源后使用 <code>nginx</code> 进行部署或者直接由和后台代码放在一起。</p><h2 id="限制跨域访问是浏览器的安全策略-主要有两种" tabindex="-1"><a class="header-anchor" href="#限制跨域访问是浏览器的安全策略-主要有两种" aria-hidden="true">#</a> 限制跨域访问是浏览器的安全策略，主要有两种：</h2><ul><li><code>DOM</code> 同源策略：禁止对不同源页面 <code>DOM</code> 进行操作。这里主要场景是 <code>iframe</code> 跨域的情况，不同<strong>域</strong>的 <code>iframe</code> 是限制互相访问的。</li><li><code>XMLHttpRequest</code> 同源策略：禁止使用 <code>XHR</code> 对象向不同<strong>域</strong>发起 <code>HTTP</code> 请求。</li></ul><h2 id="为什么浏览器要这样做" tabindex="-1"><a class="header-anchor" href="#为什么浏览器要这样做" aria-hidden="true">#</a> 为什么浏览器要这样做？</h2><p>当然是为了安全啊</p><p>我们假设有两个<strong>域</strong>:</p><ul><li><strong>域</strong>1：存着你血汗钱的网站： <code>http://money.com</code></li><li><strong>域</strong>：一个恶意网站： <code>http://坏人.com</code></li></ul><p>为了方便在客户端存储少量信息，浏览器推出了 <code>cookie</code> 这样的功能。</p><blockquote><p>即浏览器每次发起 <code>http</code> 请求，浏览器都会自动带上这个<strong>域</strong>的 <code>cookie</code>， 比如访问 <code>http://money.com</code> 的主页，浏览器则会自动帮你带上 <code>http://money.com</code> 这个<strong>域</strong>的 <code>cookie</code></p></blockquote><p>这样可以很方便的使得 <code>http://money.com</code> 的后台程序根据 <code>cookie</code> 所携带的信息来改善用户的使用体验，最常用的就是以此来识别用户，使用户保持登录状态。但是这样有一个副作用：</p><blockquote><p>即使你是在其它<strong>域</strong>通过 <code>XMLHttpRequest</code> 对象发起这个 <code>http</code> 请求，也同样是带上 <code>money.com</code> 这个<strong>域</strong>的 <code>cookie</code>。这就给坏人带来了机会</p></blockquote><p><strong>试想这样一个场景</strong>:</p><p>你刚登录了 <code>http://money.com</code> 这个网站，验证信息保存在 <code>cookie</code> 里，而且还没有过期。然后你又进入了 <code>http://坏人.com</code> 这个网站，坏人网站载入的时候就在后台用 <code>XMLHttpRequest</code> 对象向 <code>http://money.com</code> 发请求。如果浏览器不管不顾，直接就允许了，那这个请求就带着 <code>cookie</code> 发出去了，服务端一看 <code>cookie</code> 里的验证信息，是 <code>OK</code> 的。坏人不就得到服务器返回的信息了么，然后他就拿着你的信息做坏事了，好可怕。</p><p>实际上呢，以 <code>google-chrome</code> 为例（<code>google-chrome</code> 默认打开了相关的安全策略）：</p><ol><li>如果服务端允许任何其它域来请求：则允许这个请求，然后坏人就得逞了。</li><li>如果服务端只允许指定的域来请求：发现这个请求来自于<code>http://坏人.com</code> 域，不在设定的许可名单里，则不会允许这个陌生的请求</li></ol><blockquote><p>当我们关闭了 <code>google-chrome</code> 的安全策略的时候，这个请求直接就发出去了，根本不管服务端允许不允许的。这是怎么实现的呢，请求里不带发送域或者是直接将发送域替换成目的域吗？</p></blockquote><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/ziqiangxu/ziqiangxu.github.io/edit/main/docs/network-secure/关闭chrome的安全策略.md" rel="noopener noreferrer" target="_blank" aria-label="改进这篇文章"><!--[--><!--]--> 改进这篇文章 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">最后更新: </span><span class="meta-item-info">10/6/2020, 10:03:47 PM</span></div><!----></footer><!----><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/blog/assets/js/runtime~app.db6fef8c.js" defer></script><script src="/blog/assets/js/4640.00e4fdf7.js" defer></script><script src="/blog/assets/js/app.dc61d781.js" defer></script>
  </body>
</html>
